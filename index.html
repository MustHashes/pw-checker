<html>
	<head>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<script src="/js/zxcvbn.js"></script>
		<link href="//netdna.bootstrapcdn.com/bootswatch/3.1.0/yeti/bootstrap.min.css" rel="stylesheet">
		<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
		<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
		<style>


			@media screen and (max-width: 500px){
				.start, .rules, .quit, .hard, .medium, .easy, .submit, .check-button, .begin{
				border-radius: 30px;
				min-width: 80%;
				}
			}
			.canvas-container{
				background: #333;
				box-shadow: 1px 5px 4px 4px #ccc;
				min-height: 60%;
				max-width: 80%;
				margin: 0 auto;
				clear: both;
				float: center;
			}
			.content{
				-webkit-transition:all .5s ease-in-out;
				opacity: 1;
			}
			.slide-out{
				-webkit-transform:translate3d(-500%, 0, 0);
				opacity: 0;
			}
			.slide-in{
				-webkit-transform:translate3d(1000%, 0, 0);
				opacity: 0;
			}
			.form{
				float: center;
				clear: both;
			}
			.lock{
				font-size: 4em;
				color: #FFAA06;
			}
			.padding-top{
				margin-top: 10px;
			}
			.start, .rules, .quit, .check-button{
				border-radius: 30px;
				min-width: 40%;
			}
			
			.hard{
				margin-top: 12%;
				border-radius: 30px;
				min-width: 40%;
			}
			.medium, .easy, .begin{
				border-radius: 30px;
				min-width: 40%;
			}
			
			.top-space{
				margin-top: 8%;
			}
			
			.target{
				margin-right: 5%;
				width: 90px;
				height: 90px;
			}
			.target-content{
				margin-left: 20%;\
				min-width: 70%;
			}
			.title{
				margin: 0 auto;
				float:center;
				text-align: center;
			}
		</style>
		<script>
		window.requestAnimFrame = (function(){
			return  window.requestAnimationFrame       ||
			      window.webkitRequestAnimationFrame ||
			      window.mozRequestAnimationFrame    ||
			      function( callback ){
			        window.setTimeout(callback, 1000 / 60);
			      };
		})();

			var Mhash = {};
			Mhash.Enemy = function(pos, img){

				this.pos = {};
				this.pos.x = pos.x || 0;
				this.pos.y = pos.y || 0;

				this.img = img;
			};
			Mhash.Fort = function(pos, radius, max_health){

				this.pos.x = pos.x || 0;
				this.pos.y = pos.y || 0;

				this.radius = radius || 100;

				this.max_health = max_health || 100;
				this.current_health = max_health;

				this.count = 0;

				this.color = {
					r: 42,
					g: 186,
					b: 39
				};

			};
			Mhash.Bullet = function(pos, target, vel, usePhysics) {
				  // properties for animation
				  // and colouring
				  this.GRAVITY  = 0.06;

				  this.pos = {
				    x: pos.x || 0,
				    y: pos.y || 0
				  };

				  this.lastPos = {
				    x: this.pos.x,
				    y: this.pos.y
				  };
				  this.vel = {
				    x: vel.x || 10,
				    y: vel.y || 10
				  };

				  this.lastPos = {
				    x: this.pos.x,
				    y: this.pos.y
				  };

				  this.usePhysics = usePhysics || false;

			};
			Mhash.Bullet.prototype.move = function(){
			    this.lastPos.x = this.pos.x;
			    this.lastPos.y = this.pos.y;

			    this.vel.y += this.GRAVITY;
			    this.pos.y += this.vel.y;

			    this.pos.x += this.vel.x;
			};

			Mhash.results = $.parseHTML("<div class='row' id='results'><div class='col-md-2'></div><div class='col-md-8'><h3 id='entropy'></h3><h3 id='score'></h3></div></div>");
			Mhash.start = $.parseHTML("<div class='row'><button type='submit' class='start btn btn-success btn-lg padding-top clearfix center-block'>Start</button><button type='submit' class='rules btn btn-info btn-lg padding-top clearfix center-block'>Rules</button></div>");
			Mhash.canvas= $.parseHTML("<div class='title'><h4>Test Your Might.</h4><h4>Hackers are always trying to obtain passwords. Are you ready?</h4></div><div class='canvas-container'><canvas id='game'></canvas></div>");
			
			Mhash.modes = $.parseHTML("<div class='title'><h4>Out of the last five sites that you have created accounts for, how many unique passwords have you created?</h4></div><div class='row'><button type='submit' data-difficulty='2' class='hard difficulty btn btn-default btn-lg padding-top clearfix center-block'>1</button><button type='submit' data-difficulty='1' class='medium difficulty btn btn-default btn-lg padding-top clearfix center-block'>3</button><button type='submit' data-difficulty='0' class='easy difficulty btn btn-default btn-lg padding-top clearfix center-block'>5</button></div>");
			Mhash.passfields = $.parseHTML("<div class='row'><div class='col-md-2></div><div class='col-md-8'><form class='form' role='form' id='params'></form></div></div>");
			
			Mhash.params;
			Mhash.pwfield = $.parseHTML("<input type='password' class='form-control param' placeholder='Password'>");
			Mhash.over=$.parseHTML("<div class='row'><div class='col-md-2'></div><div class='col-md-8'><h1 class='center-block text-center'>Game Over</h1></div></div><div class='row'><div class='col-md-4'></div><div class='col-md-4'><button class='btn start btn-default center-block'>Try Again?</button><button class='btn quit btn-danger center-block padding-top'>Quit</button></div></div>");
			Mhash.lock = $.parseHTML("<h3 class='lock'><i class='fa fa-lock lock fa-6'></i></h3>");
			Mhash.begin = $.parseHTML("<button type='submit' class='begin btn btn-success btn-lg padding-top clearfix center-block'>Submit</button>")
			Mhash.dys = (function(){

			//Global paramters for your game loop
			//The purpose of these is to hold references to your game elements
			//and things like jquery objects that are expensive to create on each loop
			var defaults = {
				init1: {},
				init2: {},
				init3: {},
				difficulty: 0,
				height: 0,
				width: 0,
				passwords: 0,
				isGameplay: false,
				isMenu: false,
				isGameOver: false},
				canvas,
				context,
				$container,
				enemies = [],
				targets = [],
				bullets = [],
				imgs = [
				'/img/icons/no border/facebook500.png',
				'/img/icons/no border/googleplus-revised.png',
				'/img/icons/no border/twitter.png',
				'/img/icons/no border/email.png',
				'/img/icons/no border/instagram.png',
				]
				e_img = '/img/enemy.png',
				framecount = 0;

			var init = function(results){
				//This enables you to pass a js object
				//as an argument to your game loop and initializes variables based on them.

				//Get the canvas element, grab the 2d context to be able to manipulate it from each of the helper functions
				canvas = document.getElementById('game');
				$container = $('.canvas-container');

				//Set canvas height and width to size of container for responsive goodness
				canvas.height = 800;
				canvas.width = $container.innerWidth();
				console.log(canvas.height + ", " + canvas.width);
			    context = canvas.getContext("2d");

			    //Initialize enemies
				    enemies = [];
				    for(var i = 0; i < 3; i++){
				    	var temp = {};
				    		temp.x = 300 + (300 * i);
							temp.y = 100;
				    	enemies[i] = new Mhash.Enemy(temp, e_img);
					}

				    forts = [];
				    var num_forts = results.length,
				    	num_icons = 5;
				    switch(num_forts){
				    	case 5:
				    		break;
				    	case 3:
				    		break;
				    	case 1:
				    		break;
				    	default:
				    		break;
				    }
				    var pos = {
				    	x : 130,
				    	y: 700
				    };
				    drawing1 = new Image();
					drawing1.src = imgs[0];
					drawing2 = new Image();
					drawing2.src = imgs[1];
					drawing3 = new Image();
					drawing3.src = imgs[2];
					drawing4 = new Image();
					drawing4.src = imgs[3];
					drawing5 = new Image();
					drawing5.src = imgs[4];
				    context.drawImage(drawing1,pos.x,pos.y, 100, 100);
				    context.drawImage(drawing2,pos.x + 260,pos.y, 100, 100);
				    context.drawImage(drawing3,pos.x + 520,pos.y, 100, 100);
				    context.drawImage(drawing4,pos.x + 780,pos.y, 100, 100);
				    context.drawImage(drawing5,pos.x + 1040,pos.y, 100, 100);
				    isMenu = true;
				    context.strokeStyle = 'rgb(0,255,0)';
      				context.lineWidth = 10;
				    for(var i = 0; i<5; i++){
					    context.beginPath();
						context.arc(180+(260*i), 750, 180, 0, Math.PI*2, true);
						context.stroke(); 
						context.closePath();
					}

				    run();
				};

				var updateBullets = function(){
					for (var j = 0; j < bullets.length; j++){
						bullets[j].move();
						if (bullets[j].pos.y >= 650){
							if(bullets[j].pos.x >= 80 && bullets[j].pos.x <=280){
								bullets.splice(j, 1);
							}
							else if(bullets[j].pos.x >= 340 && bullets[j].pos.x <= 540){
								bullets.splice(j, 1);
							}
							else if(bullets[j].pos.x >= 600 && bullets[j].pos.x <= 800){
								bullets.splice(j, 1);
							}
							else if(bullets[j].pos.x >= 860 && bullets[j].pos.x <= 1060){
								bullets.splice(j, 1);
							}
							else if(bullets[j].pos.x >= 1120 && bullets[j].pos.x <= 1320){
								bullets.splice(j, 1);
							}
							else{

							}
						}

					}
					if(framecount % 5 == 0){
						var i = parseInt(Math.random() * 3);
						var position = {
						x: enemies[i].pos.x + 100,
						y: enemies[i].pos.y + 150
					};

					 var angle = (parseInt(Math.random() * 2)+1) * (Math.PI);
				     var randomVelocity =  (Math.random() * 5) + 1;
				     var particleAngle = angle;
					 var newBullet = new Mhash.Bullet(position, null, {
			            x: Math.cos(particleAngle) * randomVelocity,
			            y: Math.sin(particleAngle) * randomVelocity
			        }, true);

					bullets.push(newBullet);
					}
					
					
				};
				var drawBullets = function(){
					for (var i = 0; i < bullets.length; i++) {
			            context.fillStyle = '#fff';
			            var position = bullets[i].pos;
			            context.fillRect(position.x, position.y, 12, 12);
			        }
				};

				var run = function(){
					//Replace this if with your halt condition
					//This can be replaced with a "while(true)", but this will have serious performance implications
					framecount = framecount + 1;
					if(!defaults.isGameOver)
					{       
					  //Private animation loop functions

					  //Resets the canvas to its initial state	
			          clear();
			          //Update position of all elements on the canvas
			          update();
			          //Draw updated elements
			          draw();
			          //Add current context to the animation frame queue
			          queue();
			        }
			        else{
			           clear();
			        }
				};

				var queue = function () {
					//Add the animation loop to the frame queue
			        window.requestAnimFrame(run);
			    };
			    
			    var update = function() {
			        //define position updating logic here
			        
			        updateBullets();
			        //update target health

			        //generate random events? 
			        //Eg. random compromise based on site security, 
			    };

			    // returns health to decrease (either random compromise)
			    // or the portion of maxhealth to kill kill kill
			    var calculate = function(seconds, totalhits) {
			    	if (Math.random() < 0.01 * seconds/100) {
			    		// random compromise
			    	}
			    	
			    	// square totalhits on the obj, then take away said totalhits
			    	// from maxHealth
			    	return totalhits^2;
			    };

				var draw = function() {
				  	//define image drawing (read: context updating) logic here

				  	//Draw all objects in current context (menu, gameplay, etc.)

				    var pos = {
				    	x : 130,
				    	y: 700
				    };
				  	drawing1 = new Image();
					drawing1.src = imgs[0];
					drawing2 = new Image();
					drawing2.src = imgs[1];
					drawing3 = new Image();
					drawing3.src = imgs[2];
					drawing4 = new Image();
					drawing4.src = imgs[3];
					drawing5 = new Image();
					drawing5.src = imgs[4];
				    context.drawImage(drawing1,pos.x,pos.y, 100, 100);
				    context.drawImage(drawing2,pos.x + 260,pos.y, 100, 100);
				    context.drawImage(drawing3,pos.x + 520,pos.y, 100, 100);
				    context.drawImage(drawing4,pos.x + 780,pos.y, 100, 100);
				    context.drawImage(drawing5,pos.x + 1040,pos.y, 100, 100);
				    isMenu = true;
				    context.strokeStyle = 'rgb(0,255,0)';
      				context.lineWidth = 10;
				    for(var i = 0; i<5; i++){
					    context.beginPath();
						context.arc(180+(260*i), 750, 100, 0, Math.PI*2, true);
						context.stroke(); 
						context.closePath();
					}

					//Dynamically update enemies!

					for(var i = 0; i < 3; i++){
				    	enemy = new Image();	
						enemy.src = enemies[i].img;
						context.drawImage(enemy, enemies[i].pos.x, enemies[i].pos.y, 200, 200);
				    }
				    drawBullets();


				};


				var clear = function(){
					canvas.width = canvas.width;
				};


				//This return statement should contain a js object
				//of every "public" function for your module
				return{
					init: init
				};	


			})();


			$(document).ready(function(){
				var $this = $(this),
					result = {},
					difficulty = 0,
					num_fields;
					$this.on('click', '.check-button', function(e){
						e.preventDefault();
						console.log(zxcvbn($('#pw').val()));
						$('.content').addClass('slide-out');
						setTimeout(function(){
							$('.content').addClass('slide-in').removeClass('slide-out');
							$('.content').html(Mhash.start);
							$('.title').append(Mhash.lock);
						}, 800);
						setTimeout(function(){
							$('.content').removeClass('slide-in');
							console.log('width: ' + $('.content').innerWidth() + ", height: " + $('.content').innerHeight());
						}, 1250);

					})
					.on('click', '.start', function(e){
						e.preventDefault();
						$('.content').addClass('slide-out');
						setTimeout(function(){
							$('.lock').css('display', 'none');
							$('.content').html(Mhash.modes);
							$('.content').addClass('slide-in').removeClass('slide-out');
						}, 600);
						
						setTimeout(function(){
							$('.content').removeClass('slide-in');
							console.log('width: ' + $('.content').innerWidth() + ", height: " + $('.content').innerHeight());
								//setTimeout(function(){
								//	$this.trigger('gameOver');
								//},2000);
						}, 1250);
					})
					.on('click', '.rules', function(e){
						e.preventDefault();
						$('#rulesModal').modal()
					})
					.on('click', '.begin', function(e){
						e.preventDefault();
						var pwords = [],
							results = [];
						switch(difficulty){
							case 0:
								num_fields = 5
								break;
							case 1:
								num_fields = 3
								break;
							case 2:
								num_fields = 1
								break;
							default:
								break;
						}
						for (var i = 1; i <= num_fields; i++){
							var pfield = '#easy' + i;
							pwords.push($(pfield).val());
						}
						$('.content').addClass('slide-out');
						setTimeout(function(){
							$('.content').addClass('slide-in').removeClass('slide-out');
							$('.content').html(Mhash.canvas);
							for(var j = 0; j < pwords.length; j++){
								results.push(zxcvbn(pwords[j]));
							}
							console.log(results);
							Mhash.dys.init(results);
						}, 800);
						setTimeout(function(){
							$('.content').removeClass('slide-in');
						}, 1250);
						for(var k = 1; k <= num_fields; k++){
							if ($('#password' + k).val() == ''){
								window.alert("ERROR: Password #" + k + " can't be EMPTY!");
								break;
							}
							//console.log($('#password' + k).val());
						}
						
						if(k > num_fields){
							for (var i = 1; i <= num_fields; i++){
								pwords.push($('#password' + i).val());
							}
							$('.content').addClass('slide-out');
							setTimeout(function(){
								$('.content').addClass('slide-in').removeClass('slide-out');
								$('.content').html(Mhash.canvas);
								for(var j = 0; j < pwords.length; j++){
									results.push(zxcvbn(pwords[j]));
								}
								console.log(results);
								Mhash.dys.init();
							}, 800);
							setTimeout(function(){
								$('.content').removeClass('slide-in');
							}, 1250);
						}
					})
					.on('click', '.difficulty', function(e){
						e.preventDefault();
						difficulty = parseInt($(e.target).data('difficulty'));
						console.log(difficulty);
						num_fields = 0;
						$('.content').addClass('slide-out');
						setTimeout(function(){	
							$('.content').addClass('slide-in').removeClass('slide-out');
							$('.content').html(Mhash.passfields);
							switch(difficulty){
								case 0:
									num_fields = 5
									break;
								case 1:
									num_fields = 3
									break;
								case 2:
									num_fields = 1
									break;
								default:
									break;
							}	
								var params = document.getElementById('params');
								/*
								var passField = ;
								for(var i = 0; i < num_fields; i++){
									$('#params').append($(Mhash.pwfield));
									<input type='password' class='form-control param' placeholder='Password'>
								}*/
								var icons = ["<img height='35' width='35' src='/img/icons/no border/facebook500.png' alt='facebook' class='img-circle'>",
											"<img height='35' width='35' src='/img/icons/no border/googleplus-revised.png' alt='g+' class='img-circle'>",
											"<img height='35' width='35' src='/img/icons/no border/twitter.png' alt='twitter' class='img-circle'>",
											"<img height='35' width='35' src='/img/icons/no border/email.png' alt='email' class='img-circle'>",
											"<img height='35' width='35' src='/img/icons/no border/instagram.png' alt='instagram' class='img-circle'>",
											"<img height='35' width='35' src='/img/icons/no border/facebook500.png' alt='facebook' class='img-circle'><img style='margin-left: 0.25%;' height='35' width='35' src='/img/icons/no border/googleplus-revised.png' alt='g+' class='img-circle'>",
											"<img height='35' width='35' src='/img/icons/no border/twitter.png' alt='twitter' class='img-circle'>",
											"<img height='35' width='35' src='/img/icons/no border/email.png' alt='email' class='img-circle'><img style='margin-left: 0.25%;' height='35' width='35' src='/img/icons/no border/instagram.png' alt='instagram' class='img-circle'>",
											" ",
											" ",
											"<img height='35' width='35' src='/img/icons/no border/facebook500.png' alt='facebook' class='img-circle'><img style='margin-left: 0.25%;' height='35' width='35' src='/img/icons/no border/googleplus-revised.png' alt='g+' class='img-circle'><img style='margin-left: 0.25%;' height='35' width='35' src='/img/icons/no border/twitter.png' alt='twitter' class='img-circle'><img style='margin-left: 0.25%;' height='35' width='35' src='/img/icons/no border/email.png' alt='email' class='img-circle'><img style='margin-left: 0.25%;' height='35' width='35' src='/img/icons/no border/instagram.png' alt='instagram' class='img-circle'>"];
								
								
								
								var passField = "<div class='title'><h4>So you think you're secure? Suppose we have a similar situation. How many strong passwords can you think of?</h4><h5>Note: We do not send any passwords from the computer.</h5></div><div class='row top-space'></div>";
								for(var i=1;i<=num_fields;i++)
									passField += "<div class='row'>" + icons[difficulty*5 + i-1] + "<div class='form-group has-success has-feedback col-md-4 col-md-offset-4'><input type='password' class='form-control param center-block' id='password" + i + "' placeholder='Password #" + i + "'></div></div>";
								$("#params").append($.parseHTML(passField));
								$("#params").append(Mhash.begin);
						}, 800);
						setTimeout(function(){
							$('.content').removeClass('slide-in');
						}, 1250);
					})
					.on('gameOver', function(e){
						e.preventDefault();
						$('.content').addClass('slide-out');
						setTimeout(function(){
							$('.content').addClass('slide-in').removeClass('slide-out');
							$('.lock').css('display', '');
							$('.content').html(Mhash.over);
							//$('#entropy').html('Entropy: ' + result.entropy);
							//$('#score').html('Score: ' + result.score);
						}, 600);
						setTimeout(function(){
							$('.content').removeClass('slide-in');
							console.log('width: ' + $('.content').innerWidth() + ", height: " + $('.content').innerHeight());
						}, 1250)
					})
					.on('click', '.quit', function(e){
						e.preventDefault();
						$('.content').addClass('slide-out');
						setTimeout(function(){
							$('.content').addClass('slide-in').removeClass('slide-out');
							$('.content').html(Mhash.start);
							$('.lock').css('display', '');
							console.log(Mhash.lock);
							//$('#entropy').html('Entropy: ' + result.entropy);
							//$('#score').html('Score: ' + result.score);
						}, 600);
						setTimeout(function(){
							$('.content').removeClass('slide-in');
						}, 1250);
					});
			});
		</script>
	</head>
	<body>
		<header>
		<nav class="navbar navbar-default" role="navigation">
		  <div class="container-fluid">
		    <!-- Brand and toggle get grouped for better mobile display -->
		    <div class="navbar-header">
		      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		      </button>
		      <a class="navbar-brand" href="#">Password Checker</a>
		    </div>

		    <!-- Collect the nav links, forms, and other content for toggling -->
		    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		      <ul class="nav navbar-nav">
		      </ul>
		      <ul class="nav navbar-nav navbar-right">
		        <li style="color: white;"><h4>Team Must Hashes</h4></li>
		      </ul>
		    </div><!-- /.navbar-collapse -->
		  </div><!-- /.container-fluid -->
		</nav>
		</header>
		<main>
			<div class="title">
				<h3>Check Yo Password</h3>
			</div>
			<div class="container-fluid content">
				<div class="row top-space">
					<div class="col-md-2"></div>
					<div class="col-md-6 col-md-offset-1">
						<form class="form" role="form"> 
						    <input type="password" class="form-control" id="pw" placeholder="Password" style="min-width:25%;">
							<button type="submit" class="check-button btn btn-primary btn-lg padding-top clearfix center-block">How's My Password?</button>
						</form>
					</div>
				</div>
			</div>
			<div class='modal fade' id='rulesModal' tabindex='-1' role='dialog' aria-labelledby='rulesLabel' aria-hidden='true'><div class='modal-dialog'><div class='modal-content'><div class='modal-header'><button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button><h4 class='modal-title' id='rulesLabel'>Rules</h4></div><div class='modal-body'>The goal of the game is to make sure that your fortresses are not defeated by space invaders (or in this case, passwords against hackers). <b>Your best offense is a strong defense</b>, so make sure to utilise strong passwords.<ul><li>Make sure it's sufficiently long.</li><li>It should contain a variety of characters.</li><li>Make sure you can <em>remember</em> it!</li><li>Use common sense when choosing what password protects what service.</li><ul></div></div></div></div>
		</main>
		<footer>
		</footer>
	</body>
</html>
